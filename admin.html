<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2&family=Rajdhani:wght@600&display=swap" rel="stylesheet"/>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: 'Baloo 2', cursive;
      background: #f1f1f1;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h2, h3 {
      font-family: 'Rajdhani', sans-serif;
      color: #004d40;
    }
    input[type="text"],
    input[type="password"],
    input[type="number"] {
      padding: 12px;
      width: 80%;
      max-width: 400px;
      margin: 10px auto;
      border: 2px solid #ccc;
      border-radius: 8px;
      display: block;
      font-size: 16px;
    }
    button {
      padding: 12px 25px;
      margin-top: 10px;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s ease;
      font-family: 'Rajdhani', sans-serif;
    }
    button:hover {
      background-color: #004d40;
    }
    #panel {
      margin-top: 20px;
      padding: 20px;
      background: white;
      border-radius: 15px;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }
    hr {
      border: none;
      border-top: 2px solid #ccc;
      margin: 30px 0;
    }
    .request-box {
      text-align: left;
      background: #e0f7fa;
      padding: 10px 15px;
      margin: 10px auto;
      border-radius: 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>

  <h2>‡§è‡§°‡§Æ‡§ø‡§® ‡§≤‡•â‡§ó‡§ø‡§®</h2>
  <input type="password" id="adminPass" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°">
  <button onclick="login()">‡§≤‡•â‡§ó‡§ø‡§®</button>

  <div id="panel" style="display:none;">
    <h3>üí≥ UPI ID ‡§î‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</h3>
    <input type="text" id="upiId" placeholder="UPI ID">
    <input type="text" id="upiNum" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞">
    <button onclick="updateUPI()">UPI ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç</button>

    <hr>

    <h3>üî¢ ‡§ó‡•á‡§Æ ‡§®‡§Ç‡§¨‡§∞ ‡§Ö‡§™‡§°‡•á‡§ü</h3>
    <div id="gameNumberList">
      <div>
        <input type="text" placeholder="‡§ó‡•á‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ (‡§ú‡•à‡§∏‡•á ‡§ó‡§≤‡•Ä)" class="game-name" />
        <input type="text" placeholder="‡§®‡§Ç‡§¨‡§∞ (‡§ú‡•à‡§∏‡•á 23)" class="game-number" />
      </div>
    </div>
    <button onclick="addGameInput()">‚ûï ‡§è‡§ï ‡§î‡§∞ ‡§ó‡•á‡§Æ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
    <button onclick="updateGameNumbers()">üü¢ ‡§Ö‡§™‡§°‡•á‡§ü</button>

    <hr>

    <h3>üì• ‡§°‡§ø‡§™‡•â‡§ú‡§º‡§ø‡§ü ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü‡•ç‡§∏</h3>
    <div id="depositRequests"></div>

    <h3>üèß ‡§®‡§ø‡§ï‡§æ‡§∏‡•Ä ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü‡•ç‡§∏</h3>
    <div id="withdrawRequests"></div>

    <h3>üéÆ ‡§ó‡•á‡§Æ ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü‡•ç‡§∏</h3>
    <div id="gameRequests"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCvQqLbN0NtpE4vAd7iPGYVguCnR3KmVQA",
      authDomain: "satta-bazaar.firebaseapp.com",
      databaseURL: "https://satta-bazaar-default-rtdb.firebaseio.com",
      projectId: "satta-bazaar",
      storageBucket: "satta-bazaar.appspot.com",
      messagingSenderId: "765288695039",
      appId: "1:765288695039:web:4280573e9493f2dbd478ca"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function login() {
      const pass = document.getElementById("adminPass").value;
      if (pass === "Vishal@4820") {
        document.getElementById("panel").style.display = "block";
        loadRequests();
      } else {
        alert("‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°");
      }
    }

    function updateUPI() {
      const upi = document.getElementById("upiId").value;
      const num = document.getElementById("upiNum").value;
      if (!upi || !num) {
        alert("UPI ID ‡§î‡§∞ ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§≠‡§∞‡•á‡§Ç");
        return;
      }
      db.ref("upiDetails").set({
        upi_id: upi,
        upi_number: num
      }).then(() => {
        alert("‚úÖ UPI ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã ‡§ó‡§à");
      }).catch((error) => {
        console.error("Error updating UPI:", error);
        alert("‚ùå UPI ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä");
      });
    }

    function addGameInput() {
      const container = document.getElementById("gameNumberList");
      const div = document.createElement("div");
      div.innerHTML = `
        <input type="text" placeholder="‡§ó‡•á‡§Æ ‡§ï‡§æ ‡§®‡§æ‡§Æ" class="game-name" />
        <input type="text" placeholder="‡§®‡§Ç‡§¨‡§∞" class="game-number" />
      `;
      container.appendChild(div);
    }

    function updateGameNumbers() {
      const names = document.querySelectorAll(".game-name");
      const numbers = document.querySelectorAll(".game-number");

      const results = {};
      for (let i = 0; i < names.length; i++) {
        const name = names[i].value.trim();
        const number = numbers[i].value.trim();
        if (name && number) {
          results[name.toLowerCase()] = number;
        }
      }

      if (Object.keys(results).length === 0) {
        alert("‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ ‡§è‡§ï ‡§ó‡•á‡§Æ ‡§î‡§∞ ‡§â‡§∏‡§ï‡§æ ‡§®‡§Ç‡§¨‡§∞ ‡§°‡§æ‡§≤‡•á‡§Ç");
        return;
      }

      db.ref("gameResults").set(results).then(() => {
        alert("‚úÖ ‡§∏‡§≠‡•Ä ‡§ó‡•á‡§Æ ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§è");
      }).catch((error) => {
        console.error("Game Number Save Error:", error);
        alert("‚ùå ‡§ó‡•á‡§Æ ‡§®‡§Ç‡§¨‡§∞ ‡§∏‡•á‡§µ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§è");
      });
    }

    function loadRequests() {
      const depositBox = document.getElementById("depositRequests");
      const withdrawBox = document.getElementById("withdrawRequests");
      const gameBox = document.getElementById("gameRequests");

      depositBox.innerHTML = '';
      withdrawBox.innerHTML = '';
      gameBox.innerHTML = '';

      db.ref("depositRequests").once("value", snapshot => {
        const data = snapshot.val();
        if (data) {
          Object.keys(data).forEach(key => {
            const d = data[key];
            const div = document.createElement("div");
            div.className = "request-box";
            div.innerHTML = `
              <strong>${d.name}</strong> ‡§®‡•á ‚Çπ${d.amount} ‡§°‡§ø‡§™‡•â‡§ú‡§º‡§ø‡§ü ‡§ï‡§ø‡§Ø‡§æ<br>
              ‡§´‡•ã‡§®: ${d.phone}<br>
              UTR: ${d.utr}<br>
              ‡§ü‡§æ‡§á‡§Æ: ${d.time}<br>
              <button onclick="approveDepositFirebase('${key}', '${d.phone}', ${d.amount})">Approve</button>
            `;
            depositBox.appendChild(div);
          });
        } else {
          depositBox.innerHTML = "<i>‡§ï‡•ã‡§à ‡§°‡§ø‡§™‡•â‡§ú‡§º‡§ø‡§ü ‡§∞‡§ø‡§ï‡•ç‡§µ‡•á‡§∏‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</i>";
        }
      });

      for (let key in localStorage) {
        if (key.startsWith("withdraw_")) {
          const data = JSON.parse(localStorage.getItem(key));
          const div = document.createElement("div");
          div.className = "request-box";
          div.innerHTML = `${data.name} - ‚Çπ${data.amount}<br>
            ‡§¨‡•à‡§Ç‡§ï: ${data.bank}, A/C: ${data.account}<br>
            IFSC: ${data.ifsc}, UTR: ${data.utr}<br>
            <button onclick="approveWithdraw('${key}', '${data.phone}', ${data.amount})">Approve</button>`;
          withdrawBox.appendChild(div);
        }

        if (key.startsWith("gameRequest_")) {
          const data = JSON.parse(localStorage.getItem(key));
          const div = document.createElement("div");
          div.className = "request-box";
          div.innerHTML = `${data.phone} ‡§®‡•á <strong>${data.game}</strong> ‡§™‡§∞ <strong>${data.number}</strong> ‡§ï‡•á ‡§≤‡§ø‡§è ‚Çπ${data.amount} ‡§≤‡§ó‡§æ‡§Ø‡§æ<br>
            <small>${data.time}</small><br>
            <button onclick="approveGame('${key}')">Approve</button>`;
          gameBox.appendChild(div);
        }
      }
    }

    function approveDepositFirebase(key, phone, amount) {
      const userKey = "user_" + phone;
      const user = JSON.parse(localStorage.getItem(userKey)) || { balance: 0, history: [] };
      user.balance += amount;
      localStorage.setItem(userKey, JSON.stringify(user));

      db.ref("depositRequests/" + key).remove().then(() => {
        alert("‡§°‡§ø‡§™‡•â‡§ú‡§º‡§ø‡§ü ‡§Ö‡§™‡•ç‡§∞‡•Ç‡§µ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ");
        loadRequests();
      });
    }

    function approveWithdraw(key, phone, amount) {
      const user = JSON.parse(localStorage.getItem("user_" + phone)) || { balance: 0, history: [] };
      user.balance -= amount;
      localStorage.setItem("user_" + phone, JSON.stringify(user));
      localStorage.removeItem(key);
      loadRequests();
    }

    function approveGame(key) {
      const data = JSON.parse(localStorage.getItem(key));
      const approved = JSON.parse(localStorage.getItem("approved_games") || "[]");
      approved.push(data);
      localStorage.setItem("approved_games", JSON.stringify(approved));
      localStorage.removeItem(key);
      loadRequests();
    }
  </script>
</body>
</html>
