<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>рдПрдбрдорд┐рди рдкреИрдирд▓</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2&family=Rajdhani:wght@600&display=swap" rel="stylesheet"/>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: 'Baloo 2', cursive;
      background: #f1f1f1;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h2, h3 {
      font-family: 'Rajdhani', sans-serif;
      color: #004d40;
    }
    input[type="text"], input[type="password"], input[type="number"] {
      padding: 12px;
      width: 80%;
      max-width: 400px;
      margin: 10px auto;
      border: 2px solid #ccc;
      border-radius: 8px;
      display: block;
      font-size: 16px;
    }
    button {
      padding: 12px 25px;
      margin-top: 10px;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #004d40;
    }
    #panel {
      margin-top: 20px;
      padding: 20px;
      background: white;
      border-radius: 15px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }
    hr {
      border: none;
      border-top: 2px solid #ccc;
      margin: 30px 0;
    }
    .request-box {
      text-align: left;
      background: #e0f7fa;
      padding: 10px 15px;
      margin: 10px auto;
      border-radius: 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>

  <h2>рдПрдбрдорд┐рди рд▓реЙрдЧрд┐рди</h2>
  <input type="password" id="adminPass" placeholder="рдкрд╛рд╕рд╡рд░реНрдб">
  <button onclick="login()">рд▓реЙрдЧрд┐рди</button>

  <div id="panel" style="display:none;">
    <h3>ЁЯТ│ UPI ID рдФрд░ рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ</h3>
    <input type="text" id="upiId" placeholder="UPI ID">
    <input type="text" id="upiNum" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░">
    <button onclick="updateUPI()">UPI рд╕реЗрд╡ рдХрд░реЗрдВ</button>

    <hr>

    <h3>ЁЯФв рд╕рднреА рдЧреЗрдо рдирдВрдмрд░ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ</h3>
    <div id="gameNumberList"></div>
    <button onclick="updateGameNumbers()">ЁЯЯв рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВ</button>

    <hr>

    <h3>ЁЯУе рдбрд┐рдкреЙрдЬрд╝рд┐рдЯ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯреНрд╕</h3>
    <div id="depositRequests">рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...</div>

    <hr>

    <h3>ЁЯТ╕ рдирд┐рдХрд╛рд╕реА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯреНрд╕</h3>
    <div id="withdrawRequests">рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...</div>

  </div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCvQqLbN0NtpE4vAd7iPGYVguCnR3KmVQA",
    authDomain: "satta-bazaar.firebaseapp.com",
    databaseURL: "https://satta-bazaar-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "satta-bazaar",
    storageBucket: "satta-bazaar.appspot.com",
    messagingSenderId: "765288695039",
    appId: "1:765288695039:web:4280573e9493f2dbd478ca"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function login() {
    const pass = document.getElementById("adminPass").value;
    if (pass === "Classico@4820") {
      document.getElementById("panel").style.display = "block";
      loadUPI();
      loadDeposits();
      loadWithdrawals();
      renderGameInputs();
    } else {
      alert("тЭМ рдЧрд▓рдд рдкрд╛рд╕рд╡рд░реНрдб");
    }
  }

  function updateUPI() {
    const upi = document.getElementById("upiId").value;
    const number = document.getElementById("upiNum").value;
    if (!upi || !number) {
      alert("UPI ID рдФрд░ рдирдВрдмрд░ рджреЛрдиреЛрдВ рднрд░реЗрдВ");
      return;
    }
    db.ref("upiDetails").set({ upi, number }).then(() => {
      alert("тЬЕ UPI рдЬрд╛рдирдХрд╛рд░реА рдЕрдкрдбреЗрдЯ рд╣реЛ рдЧрдИ");
    }).catch((e) => {
      alert("тЭМ рд╕реЗрд╡ рдирд╣реАрдВ рд╣реЛ рд╕рдХреА");
      console.error(e);
    });
  }

  function loadUPI() {
    db.ref("upiDetails").on("value", (snap) => {
      const data = snap.val();
      if (data) {
        document.getElementById("upiId").value = data.upi || '';
        document.getElementById("upiNum").value = data.number || '';
      }
    });
  }

  const fullGameList = [
    "DELHI BAZAR", "MUMBAI BAZAR", "RAJASTHAN", "DESAWAR", "GALI", "FARIDABAD", "GHAZIABAD",
    "KALYAN", "KALYAN NIGHT", "MAIN MUMBAI", "MILAN DAY", "MILAN NIGHT", "RAJDHANI DAY",
    "RAJDHANI NIGHT", "TIME BAZAR", "SRIDEVI", "MADHUR DAY", "MADHUR NIGHT",
    "SUPREME DAY", "SUPREME NIGHT"
  ];

  function renderGameInputs() {
    const container = document.getElementById("gameNumberList");
    container.innerHTML = "";
    fullGameList.forEach(name => {
      const slug = name.toLowerCase().replace(/\s+/g, '');
      const div = document.createElement("div");
      div.innerHTML = `
        <input type="text" value="${name}" disabled style="background:#eee;" />
        <input type="text" placeholder="рдирдВрдмрд░" class="game-number" data-slug="${slug}" />
      `;
      container.appendChild(div);
    });
  }

  function updateGameNumbers() {
    const inputs = document.querySelectorAll(".game-number");
    const result = {};
    const timestamp = Date.now();

    inputs.forEach(input => {
      const slug = input.getAttribute("data-slug");
      const num = input.value.trim();
      if (num) {
        result[slug] = {
          number: num,
          updatedAt: timestamp
        };
      }
    });

    if (Object.keys(result).length === 0) {
      alert("рдХреГрдкрдпрд╛ рдХрдо рд╕реЗ рдХрдо рдПрдХ рдЧреЗрдо рдирдВрдмрд░ рднрд░реЗрдВ");
      return;
    }

    db.ref("gameResults").update(result).then(() => {
      alert("тЬЕ рд╕рднреА рдЧреЗрдо рдирдВрдмрд░ рд╕реЗрд╡ рд╣реЛ рдЧрдП");
    }).catch(err => {
      alert("тЭМ рдЧреЗрдо рдирдВрдмрд░ рд╕реЗрд╡ рдирд╣реАрдВ рд╣реЛ рд╕рдХреЗ");
      console.error(err);
    });
  }

  function loadDeposits() {
    const container = document.getElementById("depositRequests");
    db.ref("depositRequests").on("value", (snapshot) => {
      const data = snapshot.val();
      container.innerHTML = '';
      if (data) {
        Object.entries(data).forEach(([key, item]) => {
          const div = document.createElement("div");
          div.className = "request-box";
          div.innerHTML = `
            <strong>${item.name}</strong> рдиреЗ тВ╣${item.amount} рдбрд┐рдкреЙрдЬрд╝рд┐рдЯ рдХрд┐рдпрд╛<br>
            рдлреЛрди: ${item.phone}<br>
            UTR: ${item.utr}<br>
            <small>ЁЯХР ${item.time || ''}</small><br>
            <button onclick="approveDeposit('${key}', '${item.phone}', ${item.amount})">тЬЕ Approve</button>
          `;
          container.appendChild(div);
        });
      } else {
        container.innerHTML = "<i>рдХреЛрдИ рдбрд┐рдкреЙрдЬрд╝рд┐рдЯ рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдирд╣реАрдВ рд╣реИ</i>";
      }
    });
  }

  function approveDeposit(key, phone, amount) {
    const userKey = "user_" + phone;
    const user = JSON.parse(localStorage.getItem(userKey)) || { balance: 0, history: [] };
    user.balance += amount;
    localStorage.setItem(userKey, JSON.stringify(user));

    db.ref("depositRequests/" + key).remove().then(() => {
      alert("тЬЕ рдбрд┐рдкреЙрдЬрд╝рд┐рдЯ рдЕрдкреНрд░реВрд╡ рд╣реЛ рдЧрдпрд╛");
    });
  }

  function loadWithdrawals() {
    const container = document.getElementById("withdrawRequests");
    db.ref("withdrawRequests").on("value", (snapshot) => {
      const data = snapshot.val();
      container.innerHTML = '';
      if (data) {
        Object.entries(data).forEach(([key, item]) => {
          const div = document.createElement("div");
          div.className = "request-box";
          div.innerHTML = `
            <strong>${item.name}</strong> рдиреЗ тВ╣${item.amount} рдирд┐рдХрд╛рд▓рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛<br>
            рдлреЛрди: ${item.phone}<br>
            рдмреИрдВрдХ: ${item.bank}<br>
            рдЕрдХрд╛рдЙрдВрдЯ: ${item.account}<br>
            IFSC: ${item.ifsc}<br>
            <small>ЁЯХР ${item.time || ''}</small><br>
            <button onclick="approveWithdraw('${key}', '${item.phone}', ${item.amount})">тЬЕ Approve</button>
          `;
          container.appendChild(div);
        });
      } else {
        container.innerHTML = "<i>рдХреЛрдИ рдирд┐рдХрд╛рд╕реА рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдирд╣реАрдВ рд╣реИ</i>";
      }
    });
  }

  function approveWithdraw(key, phone, amount) {
    const userKey = "user_" + phone;
    const user = JSON.parse(localStorage.getItem(userKey)) || { balance: 0, history: [] };

    if (user.balance < amount) {
      alert("тЭМ рдЗрд╕ рдпреВрдЬрд╝рд░ рдХреЗ рдкрд╛рд╕ рдкрд░реНрдпрд╛рдкреНрдд рдмреИрд▓реЗрдВрд╕ рдирд╣реАрдВ рд╣реИ");
      return;
    }

    user.balance -= amount;
    localStorage.setItem(userKey, JSON.stringify(user));

    db.ref("withdrawRequests/" + key).remove().then(() => {
      alert("тЬЕ рдирд┐рдХрд╛рд╕реА рдЕрдкреНрд░реВрд╡ рд╣реЛ рдЧрдИ");
    });
  }
</script>
</body>
</html>
